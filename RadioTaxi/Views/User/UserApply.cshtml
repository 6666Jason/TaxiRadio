@model RadioTaxi.Models.ViewMainVM.ViewMainCRUD

@{
    ViewData["Title"] = "My Apply";

}
@section Styles {
    <link href="~/fontend/css/profile.css" rel="stylesheet" />

}
<div class="container-fluid page-header mb-5 p-0" style="background-image: url(/fontend/img/carousel-bg-1.jpg);">
    <div class="container-fluid page-header-inner py-5">
        <div class="container text-center">
            <h1 class="display-3 text-white mb-3 animated slideInDown">Profile </h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb justify-content-center text-uppercase">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Pages</a></li>
                    <li class="breadcrumb-item text-white active" aria-current="page">Profile </li>
                </ol>
            </nav>


        </div>
    </div>
</div>
<section class="ftco-section" id="confirm_vue">
    <div class="container profile-page">
        <div class="row">
            <div class="col-12 col-md-3 col-xl-3">
                <div id="avatar_sec_vue" class="panel left-panel">
                    <div class="user-meta">
                        <form id="userAvatarInput">
                            <div class="user-avatar">
                                <img id="previewImage" alt="ảnh đại diện người dùng" src="@Model.ApplicationUserMain.AvatartPath">
                                <div class="file">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.44 6.2364C17.48 6.30633 17.55 6.35627 17.64 6.35627C20.04 6.35627 22 8.3141 22 10.7114V16.6448C22 19.0422 20.04 21 17.64 21H6.36C3.95 21 2 19.0422 2 16.6448V10.7114C2 8.3141 3.95 6.35627 6.36 6.35627C6.44 6.35627 6.52 6.31632 6.55 6.2364L6.61 6.11654C6.64448 6.04397 6.67987 5.96943 6.71579 5.89376C6.97161 5.35492 7.25463 4.75879 7.43 4.40844C7.89 3.50943 8.67 3.00999 9.64 3H14.35C15.32 3.00999 16.11 3.50943 16.57 4.40844C16.7275 4.72308 16.9674 5.2299 17.1987 5.71839C17.2464 5.81921 17.2938 5.91924 17.34 6.01665L17.44 6.2364ZM16.71 10.0721C16.71 10.5716 17.11 10.9711 17.61 10.9711C18.11 10.9711 18.52 10.5716 18.52 10.0721C18.52 9.5727 18.11 9.16315 17.61 9.16315C17.11 9.16315 16.71 9.5727 16.71 10.0721ZM10.27 11.6204C10.74 11.1509 11.35 10.9012 12 10.9012C12.65 10.9012 13.26 11.1509 13.72 11.6104C14.18 12.0699 14.43 12.6792 14.43 13.3285C14.42 14.667 13.34 15.7558 12 15.7558C11.35 15.7558 10.74 15.5061 10.28 15.0466C9.82 14.5871 9.57 13.9778 9.57 13.3285V13.3185C9.56 12.6892 9.81 12.0799 10.27 11.6204ZM14.77 16.1054C14.06 16.8147 13.08 17.2542 12 17.2542C10.95 17.2542 9.97 16.8446 9.22 16.1054C8.48 15.3563 8.07 14.3774 8.07 13.3285C8.06 12.2897 8.47 11.3108 9.21 10.5616C9.96 9.81243 10.95 9.40289 12 9.40289C13.05 9.40289 14.04 9.81243 14.78 10.5516C15.52 11.3008 15.93 12.2897 15.93 13.3285C15.92 14.4173 15.48 15.3962 14.77 16.1054Z" fill="white"></path></svg>
                                    <input id="userAvatar" type="file" name="file" accept="image/gif, image/jpeg, image/png" onchange="previewFile()">
                                </div>
                            </div>
                        </form>
                        <h3 class="user-name">@ViewBag.user</h3>
                    </div>
                    <div class="left-navbar">
                        <ul>
                            <li>
                                <a href="/profile">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-gray"><mask id="mask0" maskUnits="userSpaceOnUse" x="4" y="14" width="16" height="8" style="mask-type: alpha;"><path fill-rule="evenodd" clip-rule="evenodd" d="M4 14.4961H19.8399V21.8701H4V14.4961Z" fill="white"></path></mask> <g mask="url(#mask0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.921 15.9961C7.66 15.9961 5.5 16.7281 5.5 18.1731C5.5 19.6311 7.66 20.3701 11.921 20.3701C16.181 20.3701 18.34 19.6381 18.34 18.1931C18.34 16.7351 16.181 15.9961 11.921 15.9961ZM11.921 21.8701C9.962 21.8701 4 21.8701 4 18.1731C4 14.8771 8.521 14.4961 11.921 14.4961C13.88 14.4961 19.84 14.4961 19.84 18.1931C19.84 21.4891 15.32 21.8701 11.921 21.8701Z" fill="#4E4B66"></path></g> <mask id="mask1" maskUnits="userSpaceOnUse" x="6" y="2" width="12" height="11" style="mask-type: alpha;"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.60938 2H17.2294V12.6186H6.60938V2Z" fill="white"></path></mask> <g mask="url(#mask1)"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.9204 3.42751C9.77941 3.42751 8.03741 5.16851 8.03741 7.30951C8.03041 9.44351 9.75941 11.1835 11.8914 11.1915L11.9204 11.9055V11.1915C14.0604 11.1915 15.8014 9.44951 15.8014 7.30951C15.8014 5.16851 14.0604 3.42751 11.9204 3.42751ZM11.9204 12.6185H11.8884C8.96641 12.6095 6.59941 10.2265 6.60941 7.30651C6.60941 4.38151 8.99141 1.99951 11.9204 1.99951C14.8484 1.99951 17.2294 4.38151 17.2294 7.30951C17.2294 10.2375 14.8484 12.6185 11.9204 12.6185Z" fill="#4E4B66"></path></g></svg>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-orange"><mask id="mask0" maskUnits="userSpaceOnUse" x="4" y="14" width="16" height="8" style="mask-type: alpha;"><path fill-rule="evenodd" clip-rule="evenodd" d="M4 14.4961H19.8399V21.8701H4V14.4961Z" fill="white"></path></mask> <g mask="url(#mask0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.921 15.9961C7.66 15.9961 5.5 16.7281 5.5 18.1731C5.5 19.6311 7.66 20.3701 11.921 20.3701C16.181 20.3701 18.34 19.6381 18.34 18.1931C18.34 16.7351 16.181 15.9961 11.921 15.9961ZM11.921 21.8701C9.962 21.8701 4 21.8701 4 18.1731C4 14.8771 8.521 14.4961 11.921 14.4961C13.88 14.4961 19.84 14.4961 19.84 18.1931C19.84 21.4891 15.32 21.8701 11.921 21.8701Z" fill="#FF6609"></path></g> <mask id="mask1" maskUnits="userSpaceOnUse" x="6" y="2" width="12" height="11" style="mask-type: alpha;"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.60938 2H17.2294V12.6186H6.60938V2Z" fill="white"></path></mask> <g mask="url(#mask1)"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.9204 3.42751C9.77941 3.42751 8.03741 5.16851 8.03741 7.30951C8.03041 9.44351 9.75941 11.1835 11.8914 11.1915L11.9204 11.9055V11.1915C14.0604 11.1915 15.8014 9.44951 15.8014 7.30951C15.8014 5.16851 14.0604 3.42751 11.9204 3.42751ZM11.9204 12.6185H11.8884C8.96641 12.6095 6.59941 10.2265 6.60941 7.30651C6.60941 4.38151 8.99141 1.99951 11.9204 1.99951C14.8484 1.99951 17.2294 4.38151 17.2294 7.30951C17.2294 10.2375 14.8484 12.6185 11.9204 12.6185Z" fill="#FF6609"></path></g></svg>
                                    Thông tin cá nhân
                                </a>
                            </li>
                           
                            <li @(ViewBag.active != null && ViewBag.active == "rent" ? "class=active" : "")>
                                <a href="/">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-gray"><path d="M2 22H22" stroke="#4E4B66" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M9.75 4V22H14.25V4C14.25 2.9 13.8 2 12.45 2H11.55C10.2 2 9.75 2.9 9.75 4Z" stroke="#4E4B66" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M3 10V22H7V10C7 8.9 6.6 8 5.4 8H4.6C3.4 8 3 8.9 3 10Z" stroke="#4E4B66" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 15V22H21V15C21 13.9 20.6 13 19.4 13H18.6C17.4 13 17 13.9 17 15Z" stroke="#4E4B66" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-orange"><path d="M2 22H22" stroke="#FF6609" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M9.75 4V22H14.25V4C14.25 2.9 13.8 2 12.45 2H11.55C10.2 2 9.75 2.9 9.75 4Z" stroke="#FF6609" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M3 10V22H7V10C7 8.9 6.6 8 5.4 8H4.6C3.4 8 3 8.9 3 10Z" stroke="#FF6609" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 15V22H21V15C21 13.9 20.6 13 19.4 13H18.6C17.4 13 17 13.9 17 15Z" stroke="#FF6609" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>

                                    Danh sách thuê
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-9 col-xl-9">
                <div class="profile-page panel profile-services">
                    <div class="row justify-content-center mb-5">
                        <div class="col-md-7 text-center heading-section">
                            <span class="subheading">User Rent</span>
                            <h2 class="mb-3">All user</h2>
                        </div>
                    </div>
                    <div class="row">
                        @if (Model.RenterList != null && Model.RenterList.Any())
                        {
                            @foreach (var items in Model.RenterList)
                            {
                                <div class="col-12 col-md-4">
                                    <div class="card">
                                        <img class="card-img-top" src="@items.DriversMain.ApplicationUserMain.AvatartPath" alt="@items.DriversMain.ApplicationUserMain.FullName">
                                        <div class="card-body">
                                            <h5 class="card-title">Contact Person: @items.DriversMain.ContactPerson</h5>
                                            <p class="card-text">Email: @items.DriversMain.Email</p>
                                            <p class="card-text">Mobile: @items.DriversMain.Mobile</p>
                                            <p class="card-text">City: @items.DriversMain.City</p>
                                            <a href="/driver/details/@items.DriversMain.ID" class="btn btn-primary">View More</a>

                                            @if (items.Status)
                                            {
                                                <a class="btn btn-success" href="javascript:void(0)">
                                                    Confirmed
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="btn btn-warning" href="javascript:void(0)" >
                                                    Waiting
                                                </a>
                                            }

                                        </div>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="col-sm-12 d-flex justify-content-center">
                                <div class="col-sm-10 col-sm-offset-1  text-center">
                                    <div class="four_zero_four_bg">
                                    </div>
                                    <div class="contant_box_404">
                                        <h3 class="h2">
                                            No RENT
                                        </h3>

                                        <p>No RENT!</p>


                                    </div>
                                </div>
                            </div>
                        }


                    </div>
                </div>

            </div>

        </div>

    </div>
</section>
@section Scripts{
    <script>
        $(document).ready(function () {
            $('#userAvatarInput').click(function () {
                $('#userAvatar').click();
            });

            $('#userAvatar').click(function (event) {
                event.stopPropagation();
            });
        });

        function previewFile() {
            const fileInput = document.getElementById('userAvatar');
            const preview = document.getElementById('previewImage');
            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onloadend = function () {
                preview.src = reader.result;
                sendFileToServer(file);
            };

            if (file) {
                reader.readAsDataURL(file);
            } else {
                const defaultImagePath = '@Model.ApplicationUserMain.AvatartPath';
                preview.src = defaultImagePath;
            }
        }

        function sendFileToServer(file) {
            $('#loadingMore').fadeIn();

            const formData = new FormData();
            formData.append('PrPath', file);

            axios.post('/change/img', formData, {
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            })
                .then((response) => {
                    if (response.data.code == 200) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Thành công',
                            text: 'Đã lưu thành công',
                            confirmButtonText: 'OK'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                window.location.reload();

                            }
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Lỗi',
                            text: `${response.data.message}`,
                            confirmButtonText: 'OK'
                        });
                    }
                })
                .catch(error => {
                    console.error('File upload failed:', error);
                }).finally(() => {
                    $('#loadingMore').fadeOut();
                });;
        }
    </script>
}



